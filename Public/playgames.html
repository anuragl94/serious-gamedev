<!DOCTYPE html>
<html>
<!-- Modularity gone to dump in this file -->
<head>
    <meta charset="utf-8">
    <title>Police Quad Question Generator</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-1.11.3.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <!-- Temporary -->
    <script type="text/javascript" src="../Modules/Options/shapes3.json"></script>
</head>
<body>
    <script>
        var qset = {
                    "q1": [
                    {
                        "attribute": "straightSides",
                        "comparator": "=",
                        "quantity": "4"
                    },
                    {
                        "attribute": "pairsOfSidesEqual",
                        "comparator": "=",
                        "quantity": "2"
                    },
                    {
                        "attribute": "obtuseAngles",
                        "comparator": "=",
                        "quantity": "2"
                    }
            ]
        };
        var config = {
            "questionsRepo": [
              {
                  "stage": "0",
                  "noOfOptions": "2",
                  "noOfCorrectOptions": "1",
                  "noOfClues": "1",
                  "passLimit": "3"
              },
              {
                  "stage": "1",
                  "noOfOptions": "4",
                  "noOfCorrectOptions": "1",
                  "noOfClues": "2",
                  "passLimit": "3"
              },
              {
                  "stage": "2",
                  "noOfOptions": "4",
                  "noOfCorrectOptions": "1",
                  "noOfClues": "2",
                  "passLimit": "5"
              },
              {
                  "stage": "3",
                  "noOfOptions": "4",
                  "noOfCorrectOptions": "1",
                  "noOfClues": "2",
                  "passLimit": "5"
              },
              {
                  "stage": "4",
                  "noOfOptions": "6",
                  "noOfCorrectOptions": "1",
                  "noOfClues": "3",
                  "passLimit": "10"
              },
              {
                  "stage": "5",
                  "noOfOptions": "6",
                  "noOfCorrectOptions": "1",
                  "noOfClues": "3",
                  "passLimit": "10"
              },
              {
                  "stage": "6",
                  "noOfOptions": "6",
                  "noOfCorrectOptions": "1",
                  "noOfClues": "3",
                  "passLimit": "10"
              },
              {
                  "stage": "7",
                  "noOfOptions": "8",
                  "noOfCorrectOptions": "2",
                  "noOfClues": "4",
                  "passLimit": "15"
              },
              {
                  "stage": "8",
                  "noOfOptions": "8",
                  "noOfCorrectOptions": "2",
                  "noOfClues": "4",
                  "passLimit": "15"
              },
              {
                  "stage": "9",
                  "noOfOptions": "8",
                  "noOfCorrectOptions": "2",
                  "noOfClues": "4",
                  "passLimit": "15"
              }
            ]
        };

    </script>
    <style>
        .opimg
        {
            width:200px;
            height:200px;
            border:solid 1px black;
        }
    </style>
    <div class="navbar" style="color:white;background-color:rgba(31, 137, 224, 1);">
        <h1>Police Quad</h1>
    </div>
    <h3 style="padding-left:4em;">
        One of the shapes is the culprit.<br>
        Click on the innocent shapes to ELIMINATE them.<br>
        The last one left is the culprit â€“ ARREST IT!
    </h3>
    <div class="row">
        <div class="col-md-9">
            <div id="oprow1" class="row">
                <div id="opdiv1" class="col-md-2 col-md-offset-1">
                    <label >
                        <img id="op1" class="opimg" />
                        <input type="checkbox" style="margin-left:90px;"/>
                    </label>

                </div>
                <div id="opdiv2" class="col-md-2 col-md-offset-1">
                    <label>
                        <img id="op2" class="opimg" />
                        <input type="checkbox" style="margin-left:90px;" />
                    </label>
                </div>
                <div id="opdiv3" class="col-md-2 col-md-offset-1">
                    <label>
                        <img id="op3" class="opimg"/>
                        <input type="checkbox" style="margin-left:90px;"/>
                    </label>
                </div>
            </div>
            <br />
            <div id="oprow2" class="row">
                <div id="opdiv4" class="col-md-2 col-md-offset-1">
                    <label>
                        <img id="op4" class="opimg" />
                        <input type="checkbox" style="margin-left:90px;" />
                    </label>
                </div>
                <div id="opdiv5" class="col-md-2 col-md-offset-1">
                    <label>
                        <img id="op5" class="opimg" />
                        <input type="checkbox" style="margin-left:100px;" />
                    </label>
                </div>
                <div id="opdiv6" class="col-md-2 col-md-offset-1">
                    <label>
                        <img id="op6" class="opimg" />
                        <input type="checkbox" style="margin-left:100px;" />
                    </label>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <h2>Clues</h2>
            <div id="Clues"></div>
            <h2>Tools</h2>
            <!--Insert tools here-->
            <button onclick="genClue()">
                <img src="../Modules/Options/inspect.jpg" height=70 />
            </button>
            <button onclick="makeArrest()">
                <img src="../Modules/Options/makeArrest.gif" height=70 />
            </button>
            <img id="energyImage" src="../Modules/Options/battery4.jpg" />
        </div>
    </div>
    <script>
        function isInArray(value, array) {
            return array.indexOf(value) > -1;
        }
        var noOfClues = parseInt(config.questionsRepo[4].noOfClues);
        var noOfOptions = parseInt(config.questionsRepo[4].noOfOptions);
        var noOfCorrectOptions = parseInt(config.questionsRepo[4].noOfCorrectOptions);
        var Options = new Array(noOfOptions);
        var correctOptions = new Array(noOfCorrectOptions);
        var shapesJSON = JSON.parse(shapes3);
        var optionDoms = document.getElementsByClassName("opimg");
        var shapesJSON = JSON.parse(shapes3);
        var fitCount = 0;
        for(var i = 0; i< noOfOptions && noOfClues >= 0;i++)
        {
            for (var j = 0; j < shapesJSON.length; j++) {
                var shape = shapesJSON[j];
                if(noOfClues==3)
                {
                    if (qset.q1[0].attribute == "straightSides" && qset.q1[0].comparator == "=" && parseInt(qset.q1[0].quantity) == parseInt(shape.straightSides) && !isInArray(shape.id,Options) ) {
                        Options[i] = shape.id;
                        fitCount++;
                        if (fitCount == 2) {
                            fitCount = 0;
                            noOfClues--;
                            j = 0;
                        }
                        break;
                    }
                    
                }
                else if(noOfClues==2)
                {
                    if (qset.q1[1].attribute == "pairsOfSidesEqual" && qset.q1[1].comparator == "=" && qset.q1[1].quantity == shape.pairsOfSidesEqual && !isInArray(shape.id, Options)) {
                        Options[i] = shape.id;
                        fitCount++;
                        if (fitCount == 2) {
                            fitCount = 0;
                            noOfClues--;
                            j = 0;
                        }
                        break;
                    }
                    
                }
                else if(noOfClues==1)
                {
                    if (qset.q1[2].attribute == "obtuseAngles" && qset.q1[2].comparator == "=" && qset.q1[2].quantity == shape.obtuseAngles && !isInArray(shape.id, Options)) {
                        Options[i] = shape.id;
                        fitCount++;
                        if (fitCount == 1) {
                            fitCount = 0;
                            noOfClues--;
                            j = 0;
                        }
                        break;
                    }
                }
                else
                {
                    //Get answer
                    if (qset.q1[2].quantity == shape.obtuseAngles && qset.q1[1].quantity == shape.pairsOfSidesEqual && qset.q1[0].quantity == shape.straightSides && !isInArray(shape.id, Options))
                    {
                        Options[i] = shape.id; console.log(shape.id + "Answer");
                        break;
                    }
                    
                }
            }
            console.log(Options[i]);
        }
        Options = shuffle(Options);
        for (var i = 0; i < noOfOptions; i++)
        {
            optionDoms[i].src = "../Modules/Generators/version3/" + Options[i];
        }
        //Fisher-Yates Shuffle.
        function shuffle(array) {
            var currentIndex = array.length, temporaryValue, randomIndex;

            // While there remain elements to shuffle...
            while (0 !== currentIndex) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }

            return array;
        }
    </script>
</body>
</html>